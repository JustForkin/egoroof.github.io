!function(){"use strict";function i(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function t(i,t){var n="Loading: "+i+" / "+t;u.context.font="italic 30px Arial",u.clear(),u.context.fillText(n,u.node.width/2-100,u.node.height/2)}function n(){requestAnimationFrame(n),a.update(),u.clear(),u.drawGrass(),u.drawClouds(),u.drawUnicorns()}var e=function(){function t(n){i(this,t),this.config=n,this.isSoundsMuted=!1,this.isTerrorMode=!1,this.activeMusicName=""}return t.prototype.playMusic=function(i){var t=this;this.activeMusicName=i,"string"==typeof this.config.music[i]?this.loadMusic(i,function(){return t.playMusic(i)}):(this.pauseMusic(),this.config.music[i].play())},t.prototype.loadMusic=function(i,t){var n=this.config.music[i];this.config.music[i]=document.createElement("audio"),this.config.music[i].preload="auto",this.config.music[i].loop=!0,this.config.music[i].oncanplay=t,this.config.music[i].onerror=function(i){console.error("Unable to load file: "+i.currentTarget.src,i.currentTarget.error)},this.config.music[i].src=n},t.prototype.pauseMusic=function(){var i=this;Object.keys(this.config.music).forEach(function(t){"string"!=typeof i.config.music[t]&&i.config.music[t].pause()})},t.prototype.resumeMusic=function(){this.config.music[this.activeMusicName].play()},t}(),o=function(){function t(){i(this,t),this.current=0,this.updateTime=+new Date,this.node=document.getElementById("fps")}return t.prototype.update=function(){this.current++;var i=+new Date;i-this.updateTime>1e3&&(this.node.innerText="FPS: "+this.current,this.updateTime=i,this.current=0)},t}(),s=function(){function t(n,e){i(this,t),this.config=n,this.sound=e,this.node=document.getElementById("canvas"),this.node.width=800,this.node.height=400,this.context=this.node.getContext("2d")}return t.prototype.clear=function(){this.context.clearRect(0,0,this.node.width,this.node.height)},t.prototype.drawGrass=function(){for(var i=8;i<this.node.width;i+=40)for(var t=310;t<this.node.height;t+=30)this.context.drawImage(this.config.images.grass,i,t)},t.prototype.drawClouds=function(){var i=this;this.config.cloudsPositions.forEach(function(t,n){i.context.drawImage(i.config.images["cloud_"+n],t,0),i.config.cloudsPositions[n]+=2,i.config.cloudsPositions[n]>=i.node.width&&(i.config.cloudsPositions[n]=-i.config.images["cloud_"+n].width)})},t.prototype.drawUnicorns=function(){var i=this,t="unicorn_left",n="unicorn_right";this.sound.isTerrorMode&&(t="terrorist_left",n="terrorist_right"),this.config.unicorns.forEach(function(e,o){var s=0!==e.speedY&&e.y>=210;(e.y+i.config.images[n].height>=i.node.height||e.y<=0||s)&&(i.config.unicorns[o].speedY*=-1),(e.x+i.config.images[n].width>=i.node.width||e.x<=0)&&(i.config.unicorns[o].speedX*=-1),i.config.unicorns[o].x+=i.config.unicorns[o].speedX,i.config.unicorns[o].y+=i.config.unicorns[o].speedY,i.config.unicorns[o].speedX>0?i.context.drawImage(i.config.images[n],i.config.unicorns[o].x,i.config.unicorns[o].y):i.context.drawImage(i.config.images[t],i.config.unicorns[o].x,i.config.unicorns[o].y)})},t}(),c={images:{unicorn_right:"img/unicorn_right.png",unicorn_left:"img/unicorn_left.png",grass:"img/grass.png",cloud_0:"img/cloud_blue.png",cloud_1:"img/cloud_brown.png",cloud_2:"img/cloud_green.png",cloud_3:"img/cloud_pink.png",cloud_4:"img/cloud_red.png",terrorist_right:"img/terrorist_right.png",terrorist_left:"img/terrorist_left.png"},music:{get_lucky:"audio/daft_punk_get_lucky.mp3",cant_touch_this:"audio/mc_hammer_-_u_can_t_touch_this.mp3"},cloudsPositions:[0,185,370,555,740],unicorns:[{speedX:1,speedY:2,x:1,y:1},{speedX:2,speedY:3,x:100,y:20},{speedX:2,speedY:2,x:400,y:100},{speedX:1.5,speedY:0,x:500,y:245},{speedX:1.5,speedY:0,x:400,y:265},{speedX:1.5,speedY:0,x:300,y:285}]},r=new e(c),u=new s(c,r),a=new o,d=document.getElementById.bind(document);d("musicSwitch").addEventListener("click",function(i){i.preventDefault(),i.target.classList.contains("on")?(i.target.classList.remove("on"),i.target.classList.add("off"),r.isSoundsMuted=!0,r.pauseMusic()):(i.target.classList.remove("off"),i.target.classList.add("on"),r.isSoundsMuted=!1,r.resumeMusic())}),d("terrorMode").addEventListener("click",function(i){i.preventDefault(),r.isTerrorMode=!0,d("musicSwitch").classList.contains("off")&&(d("musicSwitch").classList.remove("off"),d("musicSwitch").classList.add("on"),r.isSoundsMuted=!1),r.playMusic("cant_touch_this"),i.target.parentNode.removeChild(i.target)}),function(i){var n=Object.keys(c.images),e=n.length,o=0;t(o,e),n.forEach(function(n){var s=c.images[n];c.images[n]=new Image,c.images[n].onload=function(){o++,t(o,e),o===e&&i()},c.images[n].onerror=function(){return console.error("Unable to load: "+s)},c.images[n].src=s})}(function(){d("musicSwitch").style.display="block",d("terrorMode").style.display="block",r.playMusic("get_lucky"),n()})}();