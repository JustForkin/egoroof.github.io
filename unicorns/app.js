!function(){"use strict";function i(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function t(i,t){var o="Loading: "+i+" / "+t;r.context.font="italic 30px Arial",r.clear(),r.context.fillText(o,r.node.width/2-100,r.node.height/2)}function o(){requestAnimationFrame(o),r.clear(),r.drawGrass(),r.drawClouds(),r.drawUnicorns()}var n=function(){function t(o){i(this,t),this.config=o,this.isSoundsMuted=!1,this.isTerrorMode=!1,this.activeMusicName=""}return t.prototype.playMusic=function(i){var t=this;this.activeMusicName=i,"string"==typeof this.config.music[i]?this.loadMusic(i,function(){return t.playMusic(i)}):(this.pauseMusic(),this.config.music[i].play())},t.prototype.loadMusic=function(i,t){var o=this.config.music[i];this.config.music[i]=document.createElement("audio"),this.config.music[i].preload="auto",this.config.music[i].loop=!0,this.config.music[i].oncanplay=t,this.config.music[i].onerror=function(i){console.error("Unable to load file: "+i.currentTarget.src,i.currentTarget.error)},this.config.music[i].src=o},t.prototype.pauseMusic=function(){var i=this;Object.keys(this.config.music).forEach(function(t){"string"!=typeof i.config.music[t]&&i.config.music[t].pause()})},t.prototype.resumeMusic=function(){this.config.music[this.activeMusicName].play()},t}(),e=function(){function t(o,n){i(this,t),this.config=o,this.sound=n,this.node=document.getElementById("canvas"),this.node.width=800,this.node.height=400,this.context=this.node.getContext("2d")}return t.prototype.clear=function(){this.context.clearRect(0,0,this.node.width,this.node.height)},t.prototype.drawGrass=function(){for(var i=8;i<this.node.width;i+=40)for(var t=310;t<this.node.height;t+=30)this.context.drawImage(this.config.images.grass,i,t)},t.prototype.drawClouds=function(){var i=this;this.config.cloudsPositions.forEach(function(t,o){i.context.drawImage(i.config.images["cloud_"+o],t,0),i.config.cloudsPositions[o]+=2,i.config.cloudsPositions[o]>=i.node.width&&(i.config.cloudsPositions[o]=-i.config.images["cloud_"+o].width)})},t.prototype.drawUnicorns=function(){var i=this,t="unicorn_left",o="unicorn_right";this.sound.isTerrorMode&&(t="terrorist_left",o="terrorist_right"),this.config.unicorns.forEach(function(n,e){var s=0!==n.speedY&&n.y>=210;(n.y+i.config.images[o].height>=i.node.height||n.y<=0||s)&&(i.config.unicorns[e].speedY*=-1),(n.x+i.config.images[o].width>=i.node.width||n.x<=0)&&(i.config.unicorns[e].speedX*=-1),i.config.unicorns[e].x+=i.config.unicorns[e].speedX,i.config.unicorns[e].y+=i.config.unicorns[e].speedY,i.config.unicorns[e].speedX>0?i.context.drawImage(i.config.images[o],i.config.unicorns[e].x,i.config.unicorns[e].y):i.context.drawImage(i.config.images[t],i.config.unicorns[e].x,i.config.unicorns[e].y)})},t}(),s={images:{unicorn_right:"img/unicorn_right.png",unicorn_left:"img/unicorn_left.png",grass:"img/grass.png",cloud_0:"img/cloud_blue.png",cloud_1:"img/cloud_brown.png",cloud_2:"img/cloud_green.png",cloud_3:"img/cloud_pink.png",cloud_4:"img/cloud_red.png",terrorist_right:"img/terrorist_right.png",terrorist_left:"img/terrorist_left.png"},music:{get_lucky:"audio/daft_punk_get_lucky.mp3",cant_touch_this:"audio/mc_hammer_-_u_can_t_touch_this.mp3"},cloudsPositions:[0,185,370,555,740],unicorns:[{speedX:1,speedY:2,x:1,y:1},{speedX:2,speedY:3,x:100,y:20},{speedX:2,speedY:2,x:400,y:100},{speedX:1.5,speedY:0,x:500,y:245},{speedX:1.5,speedY:0,x:400,y:265},{speedX:1.5,speedY:0,x:300,y:285}]},c=new n(s),r=new e(s,c),u=document.getElementById.bind(document);u("musicSwitch").addEventListener("click",function(i){i.preventDefault(),i.target.classList.contains("on")?(i.target.classList.remove("on"),i.target.classList.add("off"),c.isSoundsMuted=!0,c.pauseMusic()):(i.target.classList.remove("off"),i.target.classList.add("on"),c.isSoundsMuted=!1,c.resumeMusic())}),u("terrorMode").addEventListener("click",function(i){i.preventDefault(),c.isTerrorMode=!0,u("musicSwitch").classList.contains("off")&&(u("musicSwitch").classList.remove("off"),u("musicSwitch").classList.add("on"),c.isSoundsMuted=!1),c.playMusic("cant_touch_this"),i.target.parentNode.removeChild(i.target)}),function(i){var o=Object.keys(s.images),n=o.length,e=0;t(e,n),o.forEach(function(o){var c=s.images[o];s.images[o]=new Image,s.images[o].onload=function(){e++,t(e,n),e===n&&i()},s.images[o].onerror=function(){return console.error("Unable to load: "+c)},s.images[o].src=c})}(function(){u("musicSwitch").style.display="block",u("terrorMode").style.display="block",c.playMusic("get_lucky"),o()})}();